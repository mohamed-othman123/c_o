@if (status() === 'loading') {
  <div
    class="py-3xl sm:px-3xl col-span-12 px-4"
    data-testid="accounts_div_loadingState">
    <scb-skeleton
      width="15%"
      height="40px" />
    <scb-skeleton width="50%" />
    <scb-skeleton width="50%" />
    <scb-skeleton width="80%" />
    <scb-skeleton width="90%" />
    <scb-skeleton width="100%" />
  </div>
} @else if (status() === 'error') {
  <div
    *transloco="let t; prefix: 'dashboard'"
    class="py-3xl sm:px-3xl col-span-12 flex w-full flex-col items-center justify-center gap-3 px-4 text-center"
    data-testid="accounts_div_errorState">
    <icon
      [name]="'api-failure'"
      class="text-3xl"
      data-testid="accounts_icon_apiFailure" />
    <h4
      class="head-2xs-s text-text-primary"
      data-testid="accounts_h4_apiError">
      {{ t('error.apiError') }}
    </h4>
    <p
      class="body-sm text-text-primary"
      data-testid="accounts_p_apiErrorDetail">
      {{ t('error.apiErrorDetail') }}
    </p>
    <button
      scbButton
      variant="ghost"
      size="sm"
      icon="refresh"
      (click)="transactionsResource.reload()"
      data-testid="accounts_button_reload">
      {{ t('error.reload') }}
    </button>
  </div>
} @else {
  <div
    *transloco="let t; prefix: 'overdraftDetailsPage.transactions'"
    class="border-border-secondary py-xl flex flex-col rounded-4xl border-1">
    <div class="gap-sm px-xl flex sm:flex-row sm:justify-between">
      @if (!isEmpty() || transactionTypesValue().length) {
        <div class="gap-md mb-4 flex flex-col px-4 sm:flex-row sm:items-center">
          <p
            class="mf-md text-text-secondary font-medium"
            data-testid="ACCOUNT_TRANSACTION_FILTER_BY">
            {{ t('filterBy') }}
          </p>

          <div class="gap-md flex items-center">
            <scb-form-field data-testid="TRANSACTION_LIST_DROPDOWN_STATUS">
              <scb-select
                #statusSelect
                [(value)]="transactionTypesValue"
                data-testid="TRANSACTION_LIST_SELECT_VALUE"
                [searchPlaceholder]="t('searchOptions')">
                <div
                  scbSelectTrigger
                  class="gap-md body-label-md-m flex items-center"
                  data-testid="ACCOUNT_TRANSACTION_SELECT_VALUE">
                  @if (transactionTypesValue() !== '') {
                    <div class="px-md py-xs body-md text-text-secondary rounded-4xl">
                      {{ t('transactionTypes.' + transactionTypesValue()) }}
                    </div>
                  } @else {
                    {{ t('filterPlaceholder') }}
                  }
                </div>
                @for (item of transactionTypes(); track item) {
                  <scb-option
                    [value]="item"
                    data-testid="ACCOUNT_TRANSACTION_STATUS_SELECT_ITEM">
                    {{ t('transactionTypes.' + item) }}
                  </scb-option>
                }
              </scb-select>
            </scb-form-field>
            @if (showClearFilter()) {
              <button
                scbButton
                size="md"
                variant="secondary"
                (click)="clearFilter()">
                {{ t('clearFilters') }}
              </button>
            }
          </div>
        </div>
      }
      <app-download-btn
        [options]="downloadOptions"
        [isEmpty]="isEmpty()">
        {{ t('downloadStatement') }}
      </app-download-btn>
    </div>

    @if (isEmpty()) {
      <div
        data-testid="ACOUNT_DETAIL_RETURNED_EMPTY"
        class="emptyState flex w-full flex-col items-center justify-center text-center">
        <icon
          [name]="'not-found'"
          data-testid="ACOUNT_DETAIL_RETURNED_EMPTY_ICON"
          class="text-3xl" />
        <h4
          data-testid="ACOUNT_DETAIL_RETURNED_EMPTY_TITLE"
          class="mt-sm mb-sm mf-2xl font-semibold">
          {{ t('NoTransactionsFoundTitle') }}
        </h4>
        <p
          data-testid="ACOUNT_DETAIL_RETURNED_EMPTY_SUBTITLE"
          class="text-text-tertiary text-sm-sm">
          {{ t('NoTransactionsFoundDesc') }}
        </p>
      </div>
    } @else {
      <p-table
        [value]="transactionsList()"
        [paginator]="false"
        [rows]="page.rows()"
        [first]="page.first()"
        [totalRecords]="totalRecords()">
        <ng-template #header>
          <tr>
            <th class="!body-label-sm-m">{{ t('table.referenceNumber') }}</th>
            <th class="!body-label-sm-m">{{ t('table.transactionDate') }}</th>
            <th class="!body-label-sm-m">{{ t('table.description') }}</th>
            <th class="!body-label-sm-m">{{ t('table.debitAmount') }}</th>
            <th class="!body-label-sm-m">{{ t('table.creditAmount') }}</th>
            <th class="!body-label-sm-m">{{ t('table.balanceAfter') }}</th>
          </tr>
        </ng-template>
        <ng-template
          #body
          let-item>
          <tr>
            <td class="body-sm">
              {{ item.referenceNumber }}
            </td>
            <td>
              <date-view [value]="item.transactionDate" />
            </td>
            <td class="body-sm">
              {{ item.detailedDescription }}
            </td>
            <td>
              @if (item.debitAmount !== 0) {
                <currency-view
                  [amount]="item.debitAmount"
                  [currency]="item.currencyId"
                  size="sm" />
              }
            </td>
            <td>
              @if (item.creditAmount !== 0) {
                <currency-view
                  [amount]="item.creditAmount"
                  [currency]="item.currencyId"
                  size="sm" />
              }
            </td>
            <td>
              <currency-view
                [amount]="item.balanceAfter"
                [currency]="item.currencyId"
                size="sm" />
            </td>
          </tr>
        </ng-template>
      </p-table>
    }
  </div>

  <!-- Pagination -->
  @if (!isEmpty()) {
    <app-pagination
      [totalPages]="totalPages()"
      [totalRecords]="totalRecords()"
      [page]="page" />
  }
}
